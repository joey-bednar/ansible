- name: Install dotfiles dependencies
  become: true
  apt:
    name:
      - fzf
      - stow
      - fontconfig
    state: present
  tags:
    - dotfiles
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Download dotfiles
  git:
    repo: https://github.com/joey-bednar/dotfiles
    dest: "{{ home_dir }}/dotfiles"
    clone: yes
    update: yes
    force: yes
  tags:
    - dotfiles
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Make update dotfiles
  shell: |
    cd {{home_dir}}/dotfiles
    make update
  tags:
    - dotfiles
  when: ansible_facts["distribution"] == "Ubuntu"

# TODO: place setup script in make update
- name: Load kitty.conf
  shell: |
    bash {{home_dir}}/dotfiles/.local/bin/setup
  tags:
    - dotfiles
  when: ansible_facts["distribution"] == "Ubuntu"

- name: Reload fonts
  shell: |
    fc-cache -f -v
  tags:
    - dotfiles
  when: ansible_facts["distribution"] == "Ubuntu"
     
- name: Create personal directory
  ansible.builtin.file:
    path: "{{ home_dir }}/personal"
    state: directory
    mode: '0755'
  tags:
    - dotfiles

- name: Create work directory
  ansible.builtin.file:
    path: "{{ home_dir }}/work"
    state: directory
    mode: '0755'
  tags:
    - dotfiles
